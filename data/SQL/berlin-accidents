
CREATE TABLE accident_data
(
  key            VARCHAR NOT NULL COMMENT 'object_id + year + lor?',
  object_id      VARCHAR NOT NULL,
  street_default VARCHAR NULL     COMMENT 'old data until 2019',
  lor            INT     NULL    ,
  year_month     DATE    NULL    ,
  weekday        INT     NULL     COMMENT 'sunday = 1',
  ac_category    INT     NULL    ,
  ac_type1       INT     NULL    ,
  ac_type2       INT     NULL    ,
  ac_light       INT     NULL    ,
  is_bicycle     INT     NULL    ,
  is_car         INT     NULL    ,
  is_pedestrian  INT     NULL    ,
  is_motorcycle  INT     NULL    ,
  is_truck       INT     NULL    ,
  is_other       INT     NULL    ,
  linrefx        FLOAT   NULL    ,
  linrefy        FLOAT   NULL    ,
  ygk3           FLOAT   NULL     COMMENT 'XGCSWGS84',
  ygk3           FLOAT   NULL     COMMENT 'YGCSWGS84',
  lor            INT     NOT NULL,
  PRIMARY KEY (key)
);

CREATE TABLE city_structure
(
  structure_type_id INT     NOT NULL,
  structure_type    VARCHAR NOT NULL,
  PRIMARY KEY (structure_type_id)
);

CREATE TABLE district_index
(
  district_id INT     NOT NULL,
  district    VARCHAR NOT NULL,
  PRIMARY KEY (district_id)
);

CREATE TABLE land_use
(
  land_use_id INT NOT NULL,
  land_use        NULL    ,
  PRIMARY KEY (land_use_id)
);

CREATE TABLE LOR_2021
(
  lor             INT     NOT NULL,
  district        INT     NOT NULL COMMENT 'LOR - 1 ',
  forecast_area   INT     NULL     COMMENT 'LOR - 2',
  district_region INT     NULL     COMMENT 'LOR - 3 ',
  planning_area   INT     NULL     COMMENT 'LOR - 4 ',
  sub_district    VARCHAR NULL    ,
  street_code     INT     NULL    ,
  street_name     VARCHAR NULL    ,
  street_range    VARCHAR NULL     COMMENT '??',
  district_id     INT     NOT NULL,
  PRIMARY KEY (lor)
);

CREATE TABLE population_data
(
  key              VARCHAR NOT NULL COMMENT 'LOR + year + half_year',
  lor              INT     NOT NULL,
  year             INT     NULL    ,
  half_year        INT     NULL    ,
  total_population INT     NULL    ,
  -6               INT     NULL    ,
  6-15             INT     NULL    ,
  15-18            INT     NULL    ,
  18-27            INT     NULL    ,
  27-45            INT     NULL    ,
  45-55            INT     NULL    ,
  55-65            INT     NULL    ,
  65+              INT     NULL    ,
  lor              INT     NOT NULL,
  PRIMARY KEY (key)
);

CREATE TABLE urban_data
(
  key               INT NOT NULL,
  district_id       INT NULL    ,
  structure_type_id INT NULL    ,
  land_use_id       INT NULL    ,
  area_size         INT NULL    ,
  district_id       INT NOT NULL,
  structure_type_id INT NOT NULL,
  land_use_id       INT NOT NULL,
  PRIMARY KEY (key)
);

ALTER TABLE urban_data
  ADD CONSTRAINT FK_district_index_TO_urban_data
    FOREIGN KEY (district_id)
    REFERENCES district_index (district_id);

ALTER TABLE urban_data
  ADD CONSTRAINT FK_city_structure_TO_urban_data
    FOREIGN KEY (structure_type_id)
    REFERENCES city_structure (structure_type_id);

ALTER TABLE urban_data
  ADD CONSTRAINT FK_land_use_TO_urban_data
    FOREIGN KEY (land_use_id)
    REFERENCES land_use (land_use_id);

ALTER TABLE population_data
  ADD CONSTRAINT FK_LOR_2021_TO_population_data
    FOREIGN KEY (lor)
    REFERENCES LOR_2021 (lor);

ALTER TABLE LOR_2021
  ADD CONSTRAINT FK_district_index_TO_LOR_2021
    FOREIGN KEY (district_id)
    REFERENCES district_index (district_id);

ALTER TABLE accident_data
  ADD CONSTRAINT FK_LOR_2021_TO_accident_data
    FOREIGN KEY (lor)
    REFERENCES LOR_2021 (lor);
